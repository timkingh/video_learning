clear all
clc

width = 1280;
height = 720;
blk8_num = 80;
blk8_sets = zeros(8, 8, blk8_num);
min_v = 0;
max_v = 255;
y_mtx = zeros(height, width);
uv_mtx = zeros(height / 2, width / 2);

blk8_3_4_min = [
    0     0   255   255     0     0   255   255
    0     0   255     0     0     0     0   255
  255     0     0   255   255   255     0     0
  255     0     0     0   255   255     0     0
  255     0     0   255   255   255   255     0
    0   255     0     0   255   255   255     0
    0   255   255     0     0     0   255     0
    0   255   255   255     0     0   255   255
];

blk8_3_4_max = [
  255     0     0     0   255   255   255     0
  255     0     0     0   255     0   255     0
  255     0   255   255   255   255   255   255
    0     0   255   255     0     0     0   255
    0   255   255   255     0     0   255   255
    0     0     0     0     0     0     0   255
  255     0     0     0   255   255   255     0
  255   255     0     0   255   255   255     0
];

blk8_4_1_min = [
    0     0     0     0     0     0     0     0
  255     0   255     0   255   255   255   255
    0   255   255   255   255   255   255   255
  255   255   255   255   255   255   255   255
    0     0   255     0   255   255   255     0
    0     0     0     0     0     0     0     0
    0     0   255   255   255   255   255   255
  255   255   255   255   255   255   255   255
];

blk8_4_1_max = [
  255   255   255   255   255   255   255   255
  255   255   255     0   255     0     0   255
  255     0     0     0     0     0     0   255
    0     0     0     0     0     0     0     0
  255   255   255   255   255   255   255   255
    0   255   255   255   255   255   255   255
  255   255   255     0     0   255   255   255
    0     0     0     0     0     0     0     0
];

blk8_6_3_min = [
    0     0   255     0   255   255     0     0
  255   255     0     0     0     0   255   255
    0     0     0   255   255   255   255     0
    0   255   255   255   255   255     0     0
  255   255     0     0     0     0     0   255
    0     0     0   255     0   255     0   255
    0     0   255   255   255     0   255     0
  255   255   255     0     0     0   255   255
];

blk8_6_3_max = [
  255   255     0     0     0     0   255     0
    0     0   255   255   255   255     0     0
  255     0     0     0   255     0     0   255
  255   255     0     0     0   255   255   255
  255     0   255   255   255   255     0     0
  255   255   255     0   255   255   255   255
  255   255   255     0     0     0   255   255
    0     0   255   255   255   255   255     0
];

blk8_8_8_min = [
     0   255     0   255     0   255     0   255
   255     0   255     0   255     0   255     0
     0   255     0   255     0   255     0   255
   255     0   255     0   255     0   255     0
     0   255     0   255     0   255     0   255
   255     0   255     0   255     0   255     0
     0   255     0   255     0   255     0   255
   255     0   255     0   255     0   255     0
];

blk8_8_8_max = [
   255     0   255     0   255     0   255     0
     0   255     0   255     0   255     0   255
   255     0   255     0   255     0   255     0
     0   255     0   255     0   255     0   255
   255     0   255     0   255     0   255     0
     0   255     0   255     0   255     0   255
   255     0   255     0   255     0   255     0
     0   255     0   255     0   255     0   255
];

blk8_sets(:, :, 1) = blk8_3_4_min;
blk8_sets(:, :, 2) = blk8_3_4_max;
blk8_sets(:, :, 3) = blk8_4_1_min;
blk8_sets(:, :, 4) = blk8_4_1_max;
blk8_sets(:, :, 5) = blk8_6_3_min;
blk8_sets(:, :, 6) = blk8_6_3_max;
blk8_sets(:, :, 7) = blk8_8_8_min;
blk8_sets(:, :, 8) = blk8_8_8_max;
for k = 9:blk8_num
    blk8_sets(:, :, k) = randi([0, 255], 8, 8);
end

fid_out = fopen("F:\nfs\coef_test_roi_3.yuv", "w");

for k = 1:8:height
    blk8_idx = 0;
    for j = 1:8:width
        if rem(j - 1, 16) == 0
            blk8_idx = blk8_idx + 1;
        end
        y_mtx(k:k+7, j:j+7) = blk8_sets(:, :, blk8_idx);
    end
end

for k = 1:8:height/2
    blk8_idx = 0;
    for j = 1:8:width/2
        if rem(j - 1, 8) == 0
            blk8_idx = blk8_idx + 1;
        end
        uv_mtx(k:k+7, j:j+7) = blk8_sets(:, :, blk8_idx);
    end
end

count = fwrite(fid_out, y_mtx', 'uint8');
count = count + fwrite(fid_out, uv_mtx', 'uint8');
count = count + fwrite(fid_out, uv_mtx', 'uint8');

fprintf("fwrite %d bytes\n", count);

fclose(fid_out);